<?xml version="1.0"?> 
<project name="common library bundle" default="bundle" basedir="..">

  <property name="src" location="${commonlibs.dir}/src"/>
    
    
    <!-- =================================================================== -->
    <!-- Classpath declaration - used in the "compile" target -->
    <!-- =================================================================== -->
    <path id = "local.classpath">    
      <fileset dir="${commonlibs.dir}/lib" includes="*.jar"/>
    </path>
    
  <target name="init"> 
    <echo message="---------------Building the common libs Bundle-------------"/>
    <mkdir dir="${commonlibs.classes}"/>
  </target>
    
    <!-- =================================================================== -->
    <!-- COMPILE -->
    <!-- =================================================================== -->
  <target name = "compile" depends = "init">    
      <javac srcdir = "${commonlibs.dir}/src" 
             destdir = "${commonlibs.classes}" 
             debug = "${debug}" 
             source = "${source}" 
             includeAntRuntime = "${includeAntRuntime}">
          <classpath refid = "local.classpath"/>
       </javac>
  </target>

  <!-- =================================================================== -->
  <!-- BND -->
  <!-- =================================================================== -->
  
  <target name = "bnd"/>
    

  <target name="copy.resources" depends="init">
    <copy todir="${commonlibs.classes}/lib">
        <fileset dir="${commonlibs.dir}/lib"/>
    </copy>
  </target>

  <!-- ===================================================================================== -->
  <!-- SRC.BUNDLE - create a bundle with sources for developers -->
  <!-- ===================================================================================== -->
  <target name="src.bundle" depends="copy.resources">
    <zip destfile="${commonlibs.classes}/${commonlibs.name}src.zip">
      <fileset dir="${commonlibs.dir}/src"/>
    </zip>
    <antcall target="bundle"/>
  </target>


  <!-- ===================================================================================== -->
  <!-- BUNDLE - create a bundle to run with OSGi -->
  <!-- ===================================================================================== -->
  <target name="bundle" depends="compile,copy.resources">
    <jar basedir = "${commonlibs.classes}"
         jarfile  = "${commonlibs.jar}"
         manifest = "${commonlibs.dir}/META-INF/MANIFEST.MF"/>
  </target> 


  <target name = "junit"/>

</project>
